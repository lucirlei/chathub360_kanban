import{n as c,o as i,p as e,t as a,m as v,I as M,i as y,H as m,_ as T,s as g,e as k,a as f,g as C,F as D,j as I,W as S,k as b,f as w,c as $,x as B,h as N}from"./_plugin-vue_export-helper-BK9LWihk.js";import{k as P}from"./vue-dompurify-html-DajrD5x3.js";import{u as E}from"./useMessageFormatter-BWcWDZNI.js";import{_ as j}from"./BarChart-BoGmHJfn.js";import"./_commonjsHelpers-BosuxZz1.js";const U={class:"flex items-center px-8 py-4 bg-white border-b border-slate-100",role:"banner"},A=["href"],H={class:"flex flex-col h-14 justify-center"},L={class:"text-sm text-slate-600"},O={class:"font-medium"},V={__name:"Header",props:{responseSourcePath:{type:String,required:!0},responseSourceName:{type:String,required:!0}},setup(s){return(o,t)=>(i(),c("header",U,[e("a",{href:s.responseSourcePath,class:"text-woot-500 hover:underline mr-4"},a("Back"),8,A),t[3]||(t[3]=e("div",{class:"border border-solid border-slate-100 text-slate-700 mr-4 p-2 rounded-full"},[e("svg",{width:"24",height:"24"},[e("use",{"xlink:href":"#icon-mist-fill"})])],-1)),e("div",H,[t[2]||(t[2]=e("h1",{id:"page-title",class:"text-base font-medium text-slate-900"},a("Robin AI playground"),-1)),e("p",L,[t[0]||(t[0]=v(a("Chat with the source")+" ")),e("span",O,a(s.responseSourceName),1),t[1]||(t[1]=v(" "+a("and evaluate itâ€™s efficiency.")))])])]))}},q={class:"w-full mb-4 flex items-center justify-end"},F={class:"px-4 py-3 bg-woot-400 text-white text-sm rounded-md inline-block"},W={__name:"UserMessage",props:{message:{type:String,required:!0}},setup(s){return(o,t)=>{const d=M("dompurify-html");return i(),c("div",q,[y(e("div",F,null,512),[[d,s.message]])])}}},R={class:"w-full mb-4 flex items-center justify-start"},J={class:"px-4 py-3 bg-white max-w-4xl text-slate-700 leading-6 text-sm rounded-md inline-block border border-slate-100"},K={__name:"BotMessage",props:{message:{type:String,required:!0}},setup(s){return(o,t)=>{const d=M("dompurify-html");return i(),c("div",R,[y(e("div",J,null,512),[[d,s.message]])])}}},z="/vite/assets/typing-DYm07fFx.gif",X={class:"w-full mb-4 flex items-center justify-start"},Y={class:"px-2 py-2 bg-white max-w-4xl text-slate-700 leading-6 text-sm rounded-md inline-block border border-slate-100"},G=["src"],Q={__name:"TypingIndicator",setup(s){return(o,t)=>(i(),c("div",X,[e("div",Y,[e("img",{src:m(z),alt:"TypingIndicator",class:"h-4"},null,8,G)])]))}},Z={components:{PlaygroundHeader:V,UserMessage:W,BotMessage:K,TypingIndicator:Q},props:{componentData:{type:Object,default:()=>({})}},setup(){const{formatMessage:s}=E();return{formatMessage:s}},data(){return{messages:[],messageContent:"",isWaiting:!1}},computed:{previousMessages(){return this.messages.map(s=>({type:s.type,message:s.content}))}},mounted(){this.focusInput()},methods:{focusInput(){this.$refs.messageInput.focus()},onMessageSend(){this.addMessageToData("User",this.messageContent),this.sendMessageToServer(this.messageContent)},scrollToLastMessage(){this.$nextTick(()=>{const s=this.messages[this.messages.length-1].id;document.getElementById(`message-${s}`).scrollIntoView({behavior:"smooth"})})},addMessageToData(s,o){this.messages.push({id:this.messages.length,type:s,content:o}),this.scrollToLastMessage()},async sendMessageToServer(s){this.messageContent="",this.isWaiting=!0;const o=document.querySelector('meta[name="csrf-token"]').getAttribute("content");try{const t=await fetch(window.location.href,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":o},body:JSON.stringify({message:s,previous_messages:this.previousMessages}),credentials:"include"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const{message:d}=await t.json();this.addMessageToData("Bot",d)}catch{this.addMessageToData("bot","Error: Could not retrieve response. Please check the console for more details.")}finally{this.isWaiting=!1,this.focusInput()}}}},ee={class:"flex flex-col w-full h-full bg-slate-25"},se={class:"flex-1 px-8 py-4 overflow-auto"},te=["id"],oe={class:"w-full px-8 py-6"};function ne(s,o,t,d,l,u){const _=g("PlaygroundHeader"),h=g("UserMessage"),p=g("BotMessage"),n=g("TypingIndicator");return i(),c("section",ee,[k(_,{"response-source-name":t.componentData.responseSourceName,"response-source-path":t.componentData.responseSourcePath},null,8,["response-source-name","response-source-path"]),e("div",se,[(i(!0),c(D,null,I(l.messages,r=>(i(),c("div",{id:`message-${r.id}`,key:r.id},[r.type==="User"?(i(),f(h,{key:0,message:d.formatMessage(r.content)},null,8,["message"])):(i(),f(p,{key:1,message:d.formatMessage(r.content)},null,8,["message"]))],8,te))),128)),l.isWaiting?(i(),f(n,{key:0})):C("",!0)]),e("div",oe,[y(e("textarea",{ref:"messageInput","onUpdate:modelValue":o[0]||(o[0]=r=>l.messageContent=r),rows:4,class:"resize-none block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border !outline-2 border-slate-100 focus:ring-woot-500 focus:border-woot-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-woot-500 dark:focus:border-woot-500",placeholder:"Type a message... [CMD/CTRL + Enter to send]",autofocus:"",autocomplete:"off",onKeydown:[o[1]||(o[1]=b(w((...r)=>u.onMessageSend&&u.onMessageSend(...r),["meta"]),["enter"])),o[2]||(o[2]=b(w((...r)=>u.onMessageSend&&u.onMessageSend(...r),["ctrl"]),["enter"]))]},null,544),[[S,l.messageContent]])])])}const re=T(Z,[["render",ne]]),ae={class:"w-full h-full"},ie={class:"main-content__body main-content__body--flush"},de={class:"report--list"},ce={class:"report-card"},le={class:"metric"},ue={class:"report-card"},me={class:"metric"},pe={class:"report-card"},ge={class:"metric"},_e={class:"report-card"},he={class:"metric"},fe={__name:"Index",props:{componentData:{type:Object,default:()=>({})}},setup(s){const o=s,t=p=>{var n=[],r=[];return p.forEach(x=>{n.push(x[0]),r.push(x[1])}),{labels:n,datasets:[{type:"bar",backgroundColor:"rgb(31, 147, 255)",yAxisID:"y",label:"Conversations",data:r}]}},d=$(()=>t(o.componentData.chartData)),{accountsCount:l,usersCount:u,inboxesCount:_,conversationsCount:h}=o.componentData;return(p,n)=>(i(),c("div",ae,[n[4]||(n[4]=e("header",{class:"main-content__header",role:"banner"},[e("h1",{id:"page-title",class:"main-content__page-title"},a("Admin Dashboard"))],-1)),e("section",ie,[e("div",de,[e("div",ce,[e("div",le,a(m(l)),1),n[0]||(n[0]=e("div",null,a("Accounts"),-1))]),e("div",ue,[e("div",me,a(m(u)),1),n[1]||(n[1]=e("div",null,a("Users"),-1))]),e("div",pe,[e("div",ge,a(m(_)),1),n[2]||(n[2]=e("div",null,a("Inboxes"),-1))]),e("div",_e,[e("div",he,a(m(h)),1),n[3]||(n[3]=e("div",null,a("Conversations"),-1))])])]),k(j,{class:"p-8 w-full",collection:d.value,style:{"max-height":"500px"}},null,8,["collection"])]))}},ye={PlaygroundIndex:re,DashboardIndex:fe},xe=(s,o)=>{const t=B({data(){return{props:o}},render(){return N(ye[s],{componentData:this.props})}});t.use(P),t.mount("#app")};document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("app");if(s){const o=s.dataset.componentName,t=JSON.parse(s.dataset.props);xe(o,t)}});
