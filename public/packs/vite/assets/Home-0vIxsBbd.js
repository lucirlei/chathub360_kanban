import{m as $,u as E}from"./globalConfig-DNoPylIh.js";import{g as M}from"./utils.esm-B9vk9JJa.js";import{c as T,n as R,b as V,I as F,u as z,r as B}from"./widget-s9fkdOiY.js";import{f as W}from"./sharedFrameEvents-DuOMDK_J.js";import{c as f,n as r,o as n,F as S,j as I,q as H,e as b,_ as x,s as C,p as o,a as _,g as k,t as v,z as L,H as g,ak as G,N as D}from"./_plugin-vue_export-helper-BK9LWihk.js";import{T as P}from"./Thumbnail-CUjAwC9K.js";import{b as y,c as U}from"./index-b3F7WOf6.js";import{a as j}from"./Validators-U_Z_leEu.js";import"./vue-dompurify-html-DajrD5x3.js";import"./index-BtuGy7By.js";import"./constants-lVAyZKq6.js";import"./Branding-CGEOLrnb.js";import"./module-DBoux_do.js";import"./Icon-3PNIKml4.js";import"./index-DN3rM4CW.js";import"./_commonjsHelpers-BosuxZz1.js";const q={class:"flex"},Y={__name:"GroupedAvatars",props:{users:{type:Array,default:()=>[]},limit:{type:Number,default:4}},setup(e){const t=e,i=f(()=>t.users.slice(0,t.limit));return(c,u)=>(n(),r("div",q,[(n(!0),r(S,null,I(i.value,(s,a)=>(n(),r("span",{key:s.id,class:H([a?"ltr:-ml-4 rtl:-mr-4":"","inline-block rounded-full text-white shadow-solid"])},[b(P,{size:"36px",username:s.name,src:s.avatar_url,"has-border":""},null,8,["username","src"])],2))),128))]))}},J={name:"TeamAvailability",components:{GroupedAvatars:Y},mixins:[T,R,V],props:{availableAgents:{type:Array,default:()=>{}},hasConversation:{type:Boolean,default:!1}},emits:["startConversation"],computed:{...$({widgetColor:"appConfig/getWidgetColor"}),textColor(){return M(this.widgetColor)},agentAvatars(){return this.availableAgents.map(e=>({name:e.name,avatar:e.avatar_url,id:e.id}))},isOnline(){const{workingHoursEnabled:e}=this.channelConfig,t=this.availableAgents.length>0;return e?this.isInBetweenTheWorkingHours:t}},methods:{startConversation(){this.$emit("startConversation"),this.hasConversation||F.sendMessage({event:"onEvent",eventIdentifier:W,data:{hasConversation:!1}})}}},K={class:"flex flex-col gap-3 w-full shadow outline-1 outline outline-n-container rounded-xl bg-n-background dark:bg-n-solid-2 px-5 py-4"},Q={class:"flex items-center justify-between gap-2"},X={class:"flex flex-col gap-1"},Z={class:"font-medium text-n-slate-12"},ee={class:"text-n-slate-11"};function te(e,t,i,c,u,s){const a=C("GroupedAvatars");return n(),r("div",K,[o("div",Q,[o("div",X,[o("div",Z,v(s.isOnline?e.$t("TEAM_AVAILABILITY.ONLINE"):e.$t("TEAM_AVAILABILITY.OFFLINE")),1),o("div",ee,v(e.replyWaitMessage),1)]),s.isOnline?(n(),_(a,{key:0,users:i.availableAgents},null,8,["users"])):k("",!0)]),o("button",{class:"inline-flex items-center gap-1 font-medium text-n-slate-12",style:L({color:e.widgetColor}),onClick:t[0]||(t[0]=(...l)=>s.startConversation&&s.startConversation(...l))},[o("span",null,v(i.hasConversation?e.$t("CONTINUE_CONVERSATION"):e.$t("START_CONVERSATION")),1),t[1]||(t[1]=o("i",{class:"i-lucide-chevron-right size-5 mt-px"},null,-1))],4)])}const se=x(J,[["render",te]]),ae={class:"underline-offset-2 leading-6 ltr:text-left rtl:text-right text-base"},ne={__name:"ArticleListItem",props:{link:{type:String,default:""},title:{type:String,default:""}},emits:["selectArticle"],setup(e,{emit:t}){const i=e,c=t,u=()=>{c("selectArticle",i.link)};return(s,a)=>(n(),r("div",{class:"flex items-center justify-between rounded cursor-pointer text-n-slate-11 hover:text-n-slate-12 gap-2",role:"button",onClick:u},[o("button",ae,v(e.title),1),a[0]||(a[0]=o("span",{class:"i-lucide-chevron-right text-base shrink-0"},null,-1))]))}},le={class:"flex flex-col gap-3"},oe={class:"font-medium text-n-slate-12"},ie={class:"flex flex-col gap-4"},re={__name:"ArticleBlock",props:{articles:{type:Array,default:()=>[]}},emits:["view","viewAll"],setup(e,{emit:t}){const i=e,c=t,u=y("appConfig/getWidgetColor"),s=f(()=>i.articles.slice(0,6)),a=l=>{c("view",l)};return(l,d)=>(n(),r("div",le,[o("h3",oe,v(l.$t("PORTAL.POPULAR_ARTICLES")),1),o("div",ie,[(n(!0),r(S,null,I(s.value,p=>(n(),_(ne,{key:p.slug,link:p.link,title:p.title,onSelectArticle:a},null,8,["link","title"]))),128))]),o("div",null,[o("button",{class:"font-medium tracking-wide inline-flex",style:L({color:g(u)}),onClick:d[0]||(d[0]=p=>l.$emit("viewAll"))},[o("span",null,v(l.$t("PORTAL.VIEW_ALL_ARTICLES")),1)],4)])]))}},ce={},ue={class:"py-4 space-y-4"};function de(e,t){return n(),r("div",ue,t[0]||(t[0]=[G('<div class="space-y-2 animate-pulse"><div class="h-6 bg-n-slate-5 dark:bg-n-alpha-black1 rounded w-2/5"></div></div><div class="space-y-2 animate-pulse"><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div></div><div class="space-y-2 animate-pulse"><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded w-1/5"></div></div>',3)]))}const pe=x(ce,[["render",de]]),me={key:0,class:"w-full shadow outline-1 outline outline-n-container rounded-xl bg-n-background dark:bg-n-solid-2 px-5 py-4"},ve={key:1,class:"hidden"},ge={__name:"ArticleContainer",setup(e){const t=U(),i=j(),c=E(),{prefersDarkMode:u}=z(),s=f(()=>window.chatwootWebChannel.portal),a=y("article/popularArticles"),l=y("article/uiFlags"),d=f(()=>{const{locale:m}=c,{allowed_locales:h,default_locale:A="en"}=s.value.config;return h.includes(m)?d:A}),p=()=>{s.value&&!a.value.length&&t.dispatch("article/fetch",{slug:s.value.slug,locale:d.value})},w=m=>{const h=new URLSearchParams({show_plain_layout:"true",theme:u.value?"dark":"light"}),A=`${m}?${h.toString()}`;i.push({name:"article-viewer",query:{link:A}})},O=()=>{const{portal:{slug:m}}=window.chatwootWebChannel;w(`/hc/${m}/${d.value}`)},N=f(()=>!l.value.isFetching&&!l.value.isError&&!!a.value.length);return D(()=>p()),(m,h)=>s.value&&(g(l).isFetching||g(a).length)?(n(),r("div",me,[N.value?(n(),_(re,{key:0,articles:g(a),onView:w,onViewAll:O},null,8,["articles"])):k("",!0),g(l).isFetching?(n(),_(pe,{key:1})):k("",!0)])):(n(),r("div",ve))}},fe={name:"Home",components:{ArticleContainer:ge,TeamAvailability:se},mixins:[T,B],computed:{...$({availableAgents:"agent/availableAgents",conversationSize:"conversation/getConversationSize",unreadMessageCount:"conversation/getUnreadMessageCount"})},methods:{startConversation(){return this.preChatFormEnabled&&!this.conversationSize?this.replaceRoute("prechat-form"):this.replaceRoute("messages")}}},he={class:"z-50 flex flex-col justify-end flex-1 w-full p-4 gap-4"};function _e(e,t,i,c,u,s){const a=C("TeamAvailability"),l=C("ArticleContainer");return n(),r("div",he,[b(a,{"available-agents":e.availableAgents,"has-conversation":!!e.conversationSize,"unread-count":e.unreadMessageCount,onStartConversation:s.startConversation},null,8,["available-agents","has-conversation","unread-count","onStartConversation"]),b(l)])}const Re=x(fe,[["render",_e]]);export{Re as default};
