import{e as u,m as w}from"./globalConfig-DNoPylIh.js";import{c as f,O as E,a as b,i as N}from"./widget-s9fkdOiY.js";import{F as S}from"./module-DBoux_do.js";import{u as I}from"./useMessageFormatter-BWcWDZNI.js";import{T as U}from"./Thumbnail-CUjAwC9K.js";import{_ as C,s as g,I as A,n as c,o,p as n,g as v,i as d,e as _,m as h,t as p,F as x,j as k,a as V,z as F,q as B}from"./_plugin-vue_export-helper-BK9LWihk.js";import{i as T}from"./colorHelper-DkkSNPxc.js";const O={name:"UnreadMessage",components:{Thumbnail:U},mixins:[f],props:{message:{type:String,default:""},showSender:{type:Boolean,default:!1},sender:{type:Object,default:()=>{}},campaignId:{type:Number,default:null}},setup(){const{formatMessage:e,getPlainText:s,truncateMessage:r,highlightContent:i}=I();return{formatMessage:e,getPlainText:s,truncateMessage:r,highlightContent:i}},computed:{companyName(){return`${this.$t("UNREAD_VIEW.COMPANY_FROM")} ${this.channelConfig.websiteName}`},avatarUrl(){const e=this.useInboxAvatarForBot?this.inboxAvatarUrl:"/assets/images/chatwoot_bot.png";if(this.isSenderExist(this.sender)){const{avatar_url:s}=this.sender;return s}return e},agentName(){if(this.isSenderExist(this.sender)){const{available_name:e}=this.sender;return e}return this.useInboxAvatarForBot?this.channelConfig.websiteName:this.$t("UNREAD_VIEW.BOT")},availabilityStatus(){if(this.isSenderExist(this.sender)){const{availability_status:e}=this.sender;return e}return null}},methods:{isSenderExist(e){return e&&!N(e)},onClickMessage(){this.campaignId?u.emit(E,this.campaignId):u.emit(b)}}},D={class:"chat-bubble-wrap"},L={key:0,class:"row--agent-block"},W={class:"agent--name"},z={class:"company--name"},G={class:"message-content"};function R(e,s,r,i,y,t){const m=g("Thumbnail"),l=A("dompurify-html");return o(),c("div",D,[n("button",{class:"chat-bubble agent bg-white",onClick:s[0]||(s[0]=(...a)=>t.onClickMessage&&t.onClickMessage(...a))},[r.showSender?(o(),c("div",L,[_(m,{src:t.avatarUrl,size:"20px",username:t.agentName,status:t.availabilityStatus},null,8,["src","username","status"]),d(n("span",W,null,512),[[l,t.agentName]]),d(n("span",z,null,512),[[l,t.companyName]])])):v("",!0),d(n("div",G,null,512),[[l,i.formatMessage(r.message,!1)]])])])}const $=C(O,[["render",R],["__scopeId","data-v-67c449fc"]]),j={name:"Unread",components:{FluentIcon:S,UnreadMessage:$},mixins:[f],props:{messages:{type:Array,required:!0}},emits:["close"],computed:{...w({unreadMessageCount:"conversation/getUnreadMessageCount",widgetColor:"appConfig/getWidgetColor"}),sender(){const[e]=this.messages;return e.sender||{}},isBackgroundLighter(){return T(this.widgetColor)}},methods:{openConversationView(){u.emit(b)},closeFullView(){this.$emit("close")},getMessageContent(e){const{attachments:s,content:r}=e,i=s&&s.length;return r||(i?"ðŸ“‘":"")}}},P={class:"unread-wrap",dir:"ltr"},q={class:"close-unread-wrap"},K={class:"flex items-center"},Y={class:"unread-messages"},H={class:"open-read-view-wrap"};function J(e,s,r,i,y,t){const m=g("FluentIcon"),l=g("UnreadMessage");return o(),c("div",P,[n("div",q,[n("button",{class:"button small close-unread-button",onClick:s[0]||(s[0]=(...a)=>t.closeFullView&&t.closeFullView(...a))},[n("span",K,[_(m,{class:"mr-1",icon:"dismiss",size:"12"}),h(" "+p(e.$t("UNREAD_VIEW.CLOSE_MESSAGES_BUTTON")),1)])])]),n("div",Y,[(o(!0),c(x,null,k(r.messages,(a,M)=>(o(),V(l,{key:a.id,"message-type":a.messageType,"message-id":a.id,"show-sender":!M,sender:a.sender,message:t.getMessageContent(a),"campaign-id":a.campaignId},null,8,["message-type","message-id","show-sender","sender","message","campaign-id"]))),128))]),n("div",H,[e.unreadMessageCount?(o(),c("button",{key:0,class:"button clear-button",onClick:s[1]||(s[1]=(...a)=>t.openConversationView&&t.openConversationView(...a))},[n("span",{class:B(["flex items-center",{"!text-n-slate-12":t.isBackgroundLighter}]),style:F({color:e.widgetColor})},[_(m,{class:"mr-2",size:"16",icon:"arrow-right"}),h(" "+p(e.$t("UNREAD_VIEW.VIEW_MESSAGES_BUTTON")),1)],6)])):v("",!0)])])}const ne=C(j,[["render",J],["__scopeId","data-v-88c5fe99"]]);export{ne as U};
