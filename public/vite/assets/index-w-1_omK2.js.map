{"version":3,"file":"index-w-1_omK2.js","sources":["../../../node_modules/.pnpm/@june-so+analytics-next@2.0.0/node_modules/@june-so/analytics-next/dist/pkg/plugins/ajs-destination/loader.js","../../../node_modules/.pnpm/@june-so+analytics-next@2.0.0/node_modules/@june-so/analytics-next/dist/pkg/plugins/ajs-destination/utils.js","../../../node_modules/.pnpm/@june-so+analytics-next@2.0.0/node_modules/@june-so/analytics-next/dist/pkg/plugins/ajs-destination/index.js"],"sourcesContent":["import { __awaiter, __generator, __spreadArray } from \"tslib\";\nimport { getNextIntegrationsURL } from '../../lib/parse-cdn';\nimport { loadScript, unloadScript } from '../../lib/load-script';\nfunction normalizeName(name) {\n    return name.toLowerCase().replace('.', '').replace(/\\s+/g, '-');\n}\nfunction obfuscatePathName(pathName, obfuscate) {\n    if (obfuscate === void 0) { obfuscate = false; }\n    return obfuscate ? btoa(pathName).replace(/=/g, '') : undefined;\n}\nexport function resolveIntegrationNameFromSource(integrationSource) {\n    return ('Integration' in integrationSource\n        ? integrationSource.Integration\n        : integrationSource).prototype.name;\n}\nfunction recordLoadMetrics(fullPath, ctx, name) {\n    var _a, _b;\n    try {\n        var metric = ((_b = (_a = window === null || window === void 0 ? void 0 : window.performance) === null || _a === void 0 ? void 0 : _a.getEntriesByName(fullPath, 'resource')) !== null && _b !== void 0 ? _b : [])[0];\n        // we assume everything that took under 100ms is cached\n        metric &&\n            ctx.stats.gauge('legacy_destination_time', Math.round(metric.duration), __spreadArray([\n                name\n            ], (metric.duration < 100 ? ['cached'] : []), true));\n    }\n    catch (_) {\n        // not available\n    }\n}\nexport function buildIntegration(integrationSource, integrationSettings, analyticsInstance) {\n    var integrationCtr;\n    // GA and Appcues use a different interface to instantiating integrations\n    if ('Integration' in integrationSource) {\n        var analyticsStub = {\n            user: function () { return analyticsInstance.user(); },\n            addIntegration: function () { },\n        };\n        integrationSource(analyticsStub);\n        integrationCtr = integrationSource.Integration;\n    }\n    else {\n        integrationCtr = integrationSource;\n    }\n    var integration = new integrationCtr(integrationSettings);\n    integration.analytics = analyticsInstance;\n    return integration;\n}\nexport function loadIntegration(ctx, name, version, obfuscate) {\n    return __awaiter(this, void 0, void 0, function () {\n        var pathName, obfuscatedPathName, path, fullPath, err_1, deps;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    pathName = normalizeName(name);\n                    obfuscatedPathName = obfuscatePathName(pathName, obfuscate);\n                    path = getNextIntegrationsURL();\n                    fullPath = \"\".concat(path, \"/integrations/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \"/\").concat(version, \"/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \".dynamic.js.gz\");\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, loadScript(fullPath)];\n                case 2:\n                    _a.sent();\n                    recordLoadMetrics(fullPath, ctx, name);\n                    return [3 /*break*/, 4];\n                case 3:\n                    err_1 = _a.sent();\n                    ctx.stats.gauge('legacy_destination_time', -1, [\"plugin:\".concat(name), \"failed\"]);\n                    throw err_1;\n                case 4:\n                    deps = window[\"\".concat(pathName, \"Deps\")];\n                    return [4 /*yield*/, Promise.all(deps.map(function (dep) { return loadScript(path + dep + '.gz'); }))\n                        // @ts-ignore\n                    ];\n                case 5:\n                    _a.sent();\n                    // @ts-ignore\n                    window[\"\".concat(pathName, \"Loader\")]();\n                    return [2 /*return*/, window[\n                        // @ts-ignore\n                        \"\".concat(pathName, \"Integration\")]];\n            }\n        });\n    });\n}\nexport function unloadIntegration(name, version, obfuscate) {\n    return __awaiter(this, void 0, void 0, function () {\n        var path, pathName, obfuscatedPathName, fullPath;\n        return __generator(this, function (_a) {\n            path = getNextIntegrationsURL();\n            pathName = normalizeName(name);\n            obfuscatedPathName = obfuscatePathName(name, obfuscate);\n            fullPath = \"\".concat(path, \"/integrations/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \"/\").concat(version, \"/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \".dynamic.js.gz\");\n            return [2 /*return*/, unloadScript(fullPath)];\n        });\n    });\n}\nexport function resolveVersion(settings) {\n    var _a, _b, _c, _d;\n    return ((_d = (_b = (_a = settings === null || settings === void 0 ? void 0 : settings.versionSettings) === null || _a === void 0 ? void 0 : _a.override) !== null && _b !== void 0 ? _b : (_c = settings === null || settings === void 0 ? void 0 : settings.versionSettings) === null || _c === void 0 ? void 0 : _c.version) !== null && _d !== void 0 ? _d : 'latest');\n}\n//# sourceMappingURL=loader.js.map","export var isInstallableIntegration = function (name, integrationSettings) {\n    var _a;\n    var type = integrationSettings.type, bundlingStatus = integrationSettings.bundlingStatus, versionSettings = integrationSettings.versionSettings;\n    // We use `!== 'unbundled'` (versus `=== 'bundled'`) to be inclusive of\n    // destinations without a defined value for `bundlingStatus`\n    var deviceMode = bundlingStatus !== 'unbundled' &&\n        (type === 'browser' || ((_a = versionSettings === null || versionSettings === void 0 ? void 0 : versionSettings.componentTypes) === null || _a === void 0 ? void 0 : _a.includes('browser')));\n    // checking for iterable is a quick fix we need in place to prevent\n    // errors showing Iterable as a failed destiantion. Ideally, we should\n    // fix the Iterable metadata instead, but that's a longer process.\n    return !name.startsWith('Segment') && name !== 'Iterable' && deviceMode;\n};\nexport var isDisabledIntegration = function (integrationName, globalIntegrations) {\n    var allDisableAndNotDefined = globalIntegrations.All === false &&\n        globalIntegrations[integrationName] === undefined;\n    return (globalIntegrations[integrationName] === false || allDisableAndNotDefined);\n};\n//# sourceMappingURL=utils.js.map","import { __assign, __awaiter, __generator, __spreadArray } from \"tslib\";\nimport { Alias, Group, Identify, Page, Track } from '@segment/facade';\nimport { isOffline, isOnline } from '../../core/connection';\nimport { Context, ContextCancelation } from '../../core/context';\nimport { isServer } from '../../core/environment';\nimport { attempt } from '@segment/analytics-core';\nimport { isPlanEventEnabled } from '../../lib/is-plan-event-enabled';\nimport { mergedOptions } from '../../lib/merged-options';\nimport { pWhile } from '../../lib/p-while';\nimport { PriorityQueue } from '../../lib/priority-queue';\nimport { PersistedPriorityQueue } from '../../lib/priority-queue/persisted';\nimport { applyDestinationMiddleware, } from '../middleware';\nimport { buildIntegration, loadIntegration, resolveIntegrationNameFromSource, resolveVersion, unloadIntegration, } from './loader';\nimport { isPlainObject } from '@segment/analytics-core';\nimport { isDisabledIntegration as shouldSkipIntegration, isInstallableIntegration, } from './utils';\nfunction flushQueue(xt, queue) {\n    return __awaiter(this, void 0, void 0, function () {\n        var failedQueue;\n        var _this = this;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    failedQueue = [];\n                    if (isOffline()) {\n                        return [2 /*return*/, queue];\n                    }\n                    return [4 /*yield*/, pWhile(function () { return queue.length > 0 && isOnline(); }, function () { return __awaiter(_this, void 0, void 0, function () {\n                            var ctx, result, success;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        ctx = queue.pop();\n                                        if (!ctx) {\n                                            return [2 /*return*/];\n                                        }\n                                        return [4 /*yield*/, attempt(ctx, xt)];\n                                    case 1:\n                                        result = _a.sent();\n                                        success = result instanceof Context;\n                                        if (!success) {\n                                            failedQueue.push(ctx);\n                                        }\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); })\n                        // re-add failed tasks\n                    ];\n                case 1:\n                    _a.sent();\n                    // re-add failed tasks\n                    failedQueue.map(function (failed) { return queue.pushWithBackoff(failed); });\n                    return [2 /*return*/, queue];\n            }\n        });\n    });\n}\nvar LegacyDestination = /** @class */ (function () {\n    function LegacyDestination(name, version, settings, options, integrationSource) {\n        if (settings === void 0) { settings = {}; }\n        this.options = {};\n        this.type = 'destination';\n        this.middleware = [];\n        this._ready = false;\n        this._initialized = false;\n        this.flushing = false;\n        this.name = name;\n        this.version = version;\n        this.settings = __assign({}, settings);\n        this.disableAutoISOConversion = options.disableAutoISOConversion || false;\n        this.integrationSource = integrationSource;\n        // AJS-Renderer sets an extraneous `type` setting that clobbers\n        // existing type defaults. We need to remove it if it's present\n        if (this.settings['type'] && this.settings['type'] === 'browser') {\n            delete this.settings['type'];\n        }\n        this.options = options;\n        this.buffer = options.disableClientPersistence\n            ? new PriorityQueue(4, [])\n            : new PersistedPriorityQueue(4, \"dest-\".concat(name));\n        this.scheduleFlush();\n    }\n    LegacyDestination.prototype.isLoaded = function () {\n        return this._ready;\n    };\n    LegacyDestination.prototype.ready = function () {\n        var _a;\n        return (_a = this.onReady) !== null && _a !== void 0 ? _a : Promise.resolve();\n    };\n    LegacyDestination.prototype.load = function (ctx, analyticsInstance) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var integrationSource, _b;\n            var _this = this;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this._ready || this.onReady !== undefined) {\n                            return [2 /*return*/];\n                        }\n                        if (!((_a = this.integrationSource) !== null && _a !== void 0)) return [3 /*break*/, 1];\n                        _b = _a;\n                        return [3 /*break*/, 3];\n                    case 1: return [4 /*yield*/, loadIntegration(ctx, this.name, this.version, this.options.obfuscate)];\n                    case 2:\n                        _b = (_c.sent());\n                        _c.label = 3;\n                    case 3:\n                        integrationSource = _b;\n                        this.integration = buildIntegration(integrationSource, this.settings, analyticsInstance);\n                        this.onReady = new Promise(function (resolve) {\n                            var onReadyFn = function () {\n                                _this._ready = true;\n                                resolve(true);\n                            };\n                            _this.integration.once('ready', onReadyFn);\n                        });\n                        this.onInitialize = new Promise(function (resolve) {\n                            var onInit = function () {\n                                _this._initialized = true;\n                                resolve(true);\n                            };\n                            _this.integration.on('initialize', onInit);\n                        });\n                        try {\n                            ctx.stats.increment('analytics_js.integration.invoke', 1, [\n                                \"method:initialize\",\n                                \"integration_name:\".concat(this.name),\n                            ]);\n                            this.integration.initialize();\n                        }\n                        catch (error) {\n                            ctx.stats.increment('analytics_js.integration.invoke.error', 1, [\n                                \"method:initialize\",\n                                \"integration_name:\".concat(this.name),\n                            ]);\n                            throw error;\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    LegacyDestination.prototype.unload = function (_ctx, _analyticsInstance) {\n        return unloadIntegration(this.name, this.version, this.options.obfuscate);\n    };\n    LegacyDestination.prototype.addMiddleware = function () {\n        var _a;\n        var fn = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            fn[_i] = arguments[_i];\n        }\n        this.middleware = (_a = this.middleware).concat.apply(_a, fn);\n    };\n    LegacyDestination.prototype.shouldBuffer = function (ctx) {\n        return (\n        // page events can't be buffered because of destinations that automatically add page views\n        ctx.event.type !== 'page' &&\n            (isOffline() || this._ready === false || this._initialized === false));\n    };\n    LegacyDestination.prototype.send = function (ctx, clz, eventType) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var plan, ev, planEvent, afterMiddleware, event, err_1;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this.shouldBuffer(ctx)) {\n                            this.buffer.push(ctx);\n                            this.scheduleFlush();\n                            return [2 /*return*/, ctx];\n                        }\n                        plan = (_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.plan) === null || _b === void 0 ? void 0 : _b.track;\n                        ev = ctx.event.event;\n                        if (plan && ev && this.name !== 'june.so') {\n                            planEvent = plan[ev];\n                            if (!isPlanEventEnabled(plan, planEvent)) {\n                                ctx.updateEvent('integrations', __assign(__assign({}, ctx.event.integrations), { All: false, 'june.so': true }));\n                                ctx.cancel(new ContextCancelation({\n                                    retry: false,\n                                    reason: \"Event \".concat(ev, \" disabled for integration \").concat(this.name, \" in tracking plan\"),\n                                    type: 'Dropped by plan',\n                                }));\n                                return [2 /*return*/, ctx];\n                            }\n                            else {\n                                ctx.updateEvent('integrations', __assign(__assign({}, ctx.event.integrations), planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations));\n                            }\n                            if ((planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) && (planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations[this.name]) === false) {\n                                ctx.cancel(new ContextCancelation({\n                                    retry: false,\n                                    reason: \"Event \".concat(ev, \" disabled for integration \").concat(this.name, \" in tracking plan\"),\n                                    type: 'Dropped by plan',\n                                }));\n                                return [2 /*return*/, ctx];\n                            }\n                        }\n                        return [4 /*yield*/, applyDestinationMiddleware(this.name, ctx.event, this.middleware)];\n                    case 1:\n                        afterMiddleware = _c.sent();\n                        if (afterMiddleware === null) {\n                            return [2 /*return*/, ctx];\n                        }\n                        event = new clz(afterMiddleware, {\n                            traverse: !this.disableAutoISOConversion,\n                        });\n                        ctx.stats.increment('analytics_js.integration.invoke', 1, [\n                            \"method:\".concat(eventType),\n                            \"integration_name:\".concat(this.name),\n                        ]);\n                        _c.label = 2;\n                    case 2:\n                        _c.trys.push([2, 5, , 6]);\n                        if (!this.integration) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.integration.invoke.call(this.integration, eventType, event)];\n                    case 3:\n                        _c.sent();\n                        _c.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _c.sent();\n                        ctx.stats.increment('analytics_js.integration.invoke.error', 1, [\n                            \"method:\".concat(eventType),\n                            \"integration_name:\".concat(this.name),\n                        ]);\n                        throw err_1;\n                    case 6: return [2 /*return*/, ctx];\n                }\n            });\n        });\n    };\n    LegacyDestination.prototype.track = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Track, 'track')];\n            });\n        });\n    };\n    LegacyDestination.prototype.page = function (ctx) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_b) {\n                if (((_a = this.integration) === null || _a === void 0 ? void 0 : _a._assumesPageview) && !this._initialized) {\n                    this.integration.initialize();\n                }\n                return [2 /*return*/, this.onInitialize.then(function () {\n                        return _this.send(ctx, Page, 'page');\n                    })];\n            });\n        });\n    };\n    LegacyDestination.prototype.identify = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Identify, 'identify')];\n            });\n        });\n    };\n    LegacyDestination.prototype.alias = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Alias, 'alias')];\n            });\n        });\n    };\n    LegacyDestination.prototype.group = function (ctx) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, Group, 'group')];\n            });\n        });\n    };\n    LegacyDestination.prototype.scheduleFlush = function () {\n        var _this = this;\n        if (this.flushing) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-misused-promises\n        setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.flushing = true;\n                        _a = this;\n                        return [4 /*yield*/, flushQueue(this, this.buffer)];\n                    case 1:\n                        _a.buffer = _b.sent();\n                        this.flushing = false;\n                        if (this.buffer.todo > 0) {\n                            this.scheduleFlush();\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        }); }, Math.random() * 5000);\n    };\n    return LegacyDestination;\n}());\nexport { LegacyDestination };\nexport function ajsDestinations(settings, globalIntegrations, options, routingMiddleware, legacyIntegrationSources) {\n    var _a, _b;\n    if (globalIntegrations === void 0) { globalIntegrations = {}; }\n    if (options === void 0) { options = {}; }\n    if (isServer()) {\n        return [];\n    }\n    if (settings.plan) {\n        options = options !== null && options !== void 0 ? options : {};\n        options.plan = settings.plan;\n    }\n    var routingRules = (_b = (_a = settings.middlewareSettings) === null || _a === void 0 ? void 0 : _a.routingRules) !== null && _b !== void 0 ? _b : [];\n    var remoteIntegrationsConfig = settings.integrations;\n    var localIntegrationsConfig = options.integrations;\n    // merged remote CDN settings with user provided options\n    var integrationOptions = mergedOptions(settings, options !== null && options !== void 0 ? options : {});\n    var adhocIntegrationSources = legacyIntegrationSources === null || legacyIntegrationSources === void 0 ? void 0 : legacyIntegrationSources.reduce(function (acc, integrationSource) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[resolveIntegrationNameFromSource(integrationSource)] = integrationSource, _a)));\n    }, {});\n    var installableIntegrations = new Set(__spreadArray(__spreadArray([], Object.keys(remoteIntegrationsConfig).filter(function (name) {\n        return isInstallableIntegration(name, remoteIntegrationsConfig[name]);\n    }), true), Object.keys(adhocIntegrationSources || {}).filter(function (name) {\n        return isPlainObject(remoteIntegrationsConfig[name]) ||\n            isPlainObject(localIntegrationsConfig === null || localIntegrationsConfig === void 0 ? void 0 : localIntegrationsConfig[name]);\n    }), true));\n    return Array.from(installableIntegrations)\n        .filter(function (name) { return !shouldSkipIntegration(name, globalIntegrations); })\n        .map(function (name) {\n        var integrationSettings = remoteIntegrationsConfig[name];\n        var version = resolveVersion(integrationSettings);\n        var destination = new LegacyDestination(name, version, integrationOptions[name], options, adhocIntegrationSources === null || adhocIntegrationSources === void 0 ? void 0 : adhocIntegrationSources[name]);\n        var routing = routingRules.filter(function (rule) { return rule.destinationName === name; });\n        if (routing.length > 0 && routingMiddleware) {\n            destination.addMiddleware(routingMiddleware);\n        }\n        return destination;\n    });\n}\n//# sourceMappingURL=index.js.map"],"names":["normalizeName","name","obfuscatePathName","pathName","obfuscate","resolveIntegrationNameFromSource","integrationSource","recordLoadMetrics","fullPath","ctx","_a","_b","metric","__spreadArray","buildIntegration","integrationSettings","analyticsInstance","integrationCtr","analyticsStub","integration","loadIntegration","version","__awaiter","obfuscatedPathName","path","err_1","deps","__generator","getNextIntegrationsURL","loadScript","dep","unloadIntegration","unloadScript","resolveVersion","settings","_c","_d","isInstallableIntegration","type","bundlingStatus","versionSettings","deviceMode","isDisabledIntegration","integrationName","globalIntegrations","allDisableAndNotDefined","flushQueue","xt","queue","failedQueue","_this","isOffline","pWhile","isOnline","result","success","attempt","Context","failed","LegacyDestination","options","__assign","PriorityQueue","PersistedPriorityQueue","resolve","onReadyFn","onInit","error","_ctx","_analyticsInstance","fn","_i","clz","eventType","plan","ev","planEvent","afterMiddleware","event","isPlanEventEnabled","ContextCancelation","applyDestinationMiddleware","Track","Page","Identify","Alias","Group","ajsDestinations","routingMiddleware","legacyIntegrationSources","isServer","routingRules","remoteIntegrationsConfig","localIntegrationsConfig","integrationOptions","mergedOptions","adhocIntegrationSources","acc","installableIntegrations","isPlainObject","shouldSkipIntegration","destination","routing","rule"],"mappings":"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","x_google_ignoreList":[0,1,2]}