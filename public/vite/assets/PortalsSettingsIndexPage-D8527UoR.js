import{a6 as k,c as m,w as Z,p as x,o as I,s as l,e as _,t as T,H as s,r as b,a as F,l as B,f as ee,I as te,g as U,i as se,q as V}from"./_plugin-vue_export-helper-IoQslFd3.js";import{u as y,b as Y,a as ae,c as $}from"./useBranding-CD_QbCIP.js";import{p as oe,u as Q,a as le}from"./Validators-DkQimdV0.js";import{t as M,x as ne,w as ie,y as re,s as z,z as ue,B as j,u as ce}from"./dashboard-B8DxvGhj.js";import{u as C}from"./index-DyRF4TQi.js";import{_ as de}from"./HelpCenterLayout-Cxv-mUuH.js";import{u as _e,aH as X}from"./DashboardIcon-D9a-qnXf.js";import{s as Ee}from"./typing-B_xc7lBt.js";import{c as W,r as q,u as K,b as Te,m as me,_ as G,e as Re,a as pe}from"./exports-Db5CWii1.js";import{_ as ge}from"./Avatar-CS4GuSbz.js";import{x as Oe}from"./utils.esm-dig4nDxm.js";import"./index-DN3rM4CW.js";import"./index-BtuGy7By.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-DJvhFcF9.js";import"./useKeyboardNavigableList-DBoi-hid.js";import"./helper-q29O9VCT.js";import"./Icon-Dg_4WYMY.js";import"./globals-DPjCpsAT.js";import"./vue-dompurify-html-CEAHYyWB.js";import"./module-CEpankYo.js";import"./BarChart-CqJKiiio.js";import"./constants-lVAyZKq6.js";import"./IframeLoader-BKISZm2C.js";import"./js.cookie-Cz0CWeBA.js";const Se={class:"flex flex-col w-full gap-4"},Ne={class:"flex flex-col w-full gap-2"},Ie={class:"mb-0.5 text-sm font-medium text-gray-900 dark:text-gray-50"},fe={class:"flex flex-col w-full gap-4"},Ae={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Le={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},Pe={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Ce={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},he={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},ve={class:"text-sm font-medium whitespace-nowrap text-n-slate-12 py-2.5"},De={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},xe={class:"text-sm font-medium whitespace-nowrap text-n-slate-12 py-2.5"},Ge={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Ue={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},Me={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},be={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},Fe={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},ye={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},we={class:"w-[432px] justify-start"},He={class:"flex justify-end w-full gap-2"},J=4,$e={__name:"PortalBaseSettings",props:{activePortal:{type:Object,required:!0},isFetching:{type:Boolean,default:!1}},emits:["updatePortal"],setup(A,{emit:p}){const r=A,d=p,{t:n}=y(),i=Y(),c=ae(),a=k({name:"",headerText:"",pageTitle:"",slug:"",widgetColor:"",homePageLink:"",liveChatWidgetInboxId:"",logoUrl:"",avatarBlobId:""}),R=k({...a}),O=m(()=>i.getters["inboxes/getInboxes"].filter(e=>e.channel_type==="Channel::WebWidget").map(e=>({value:e.id,label:e.name}))),E={name:{required:q,minLength:me(2)},slug:{required:W.withMessage(()=>n("HELP_CENTER.CREATE_PORTAL_DIALOG.SLUG.ERROR"),q),isValidSlug:W.withMessage(()=>n("HELP_CENTER.CREATE_PORTAL_DIALOG.SLUG.FORMAT_ERROR"),oe)},homePageLink:{url:Te}},u=K(E,a),S=m(()=>u.value.name.$error?n("HELP_CENTER.CREATE_PORTAL_DIALOG.NAME.ERROR"):""),N=m(()=>{var t;return((t=u.value.slug.$errors[0])==null?void 0:t.$message)||""}),h=m(()=>u.value.homePageLink.$error?n("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.ERROR"):""),v=m(()=>{var e,o;const t=(e=r.activePortal)==null?void 0:e.slug;return t?(o=c["portals/uiFlagsIn"].value(t))==null?void 0:o.isUpdating:!1});Z(()=>r.activePortal,t=>{var e;if(t&&!r.isFetching){if(Object.assign(a,{name:t.name,headerText:t.header_text,pageTitle:t.page_title,widgetColor:t.color,homePageLink:t.homepage_link,slug:t.slug,liveChatWidgetInboxId:(e=t.inbox)==null?void 0:e.id}),t.logo){const{logo:{file_url:o,blob_id:w}}=t;a.logoUrl=o,a.avatarBlobId=w}else a.logoUrl="",a.avatarBlobId="";Object.assign(R,a)}},{immediate:!0,deep:!0});const f=m(()=>JSON.stringify(a)!==JSON.stringify(R)),L=()=>{var e;const t={id:(e=r.activePortal)==null?void 0:e.id,slug:a.slug,name:a.name,color:a.widgetColor,page_title:a.pageTitle,header_text:a.headerText,homepage_link:a.homePageLink,blob_id:a.avatarBlobId,inbox_id:a.liveChatWidgetInboxId};d("updatePortal",t)};async function D({file:t}){try{const{fileUrl:e,blobId:o}=await _e(t);e&&(a.logoUrl=e,a.avatarBlobId=o),C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_SUCCESS"))}catch{C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_ERROR"))}}async function g(){var t;try{const e=(t=r.activePortal)==null?void 0:t.slug;await i.dispatch("portals/deleteLogo",{portalSlug:e}),C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_DELETE_SUCCESS"))}catch(e){C((e==null?void 0:e.message)||n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_DELETE_ERROR"))}}const P=t=>{Ee(t,J)?D(t):C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_SIZE_ERROR",{size:J}))},H=()=>{a.logoUrl="",a.avatarBlobId="",g()};return(t,e)=>(I(),x("div",Se,[l("div",Ne,[l("label",Ie,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.LABEL")),1),_(ge,{src:a.logoUrl,name:a.name,size:72,"allow-upload":"","icon-name":"i-lucide-building-2",onUpload:P,onDelete:H},null,8,["src","name"])]),l("div",fe,[l("div",Ae,[l("label",Le,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.NAME.LABEL")),1),_(M,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.name=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.NAME.PLACEHOLDER"),"message-type":S.value?"error":"info",message:S.value,"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:e[1]||(e[1]=o=>s(u).name.$touch()),onBlur:e[2]||(e[2]=o=>s(u).name.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",Pe,[l("label",Ce,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HEADER_TEXT.LABEL")),1),_(M,{modelValue:a.headerText,"onUpdate:modelValue":e[3]||(e[3]=o=>a.headerText=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HEADER_TEXT.PLACEHOLDER"),"custom-input-class":"!bg-transparent dark:!bg-transparent"},null,8,["modelValue","placeholder"])]),l("div",he,[l("label",ve,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.PAGE_TITLE.LABEL")),1),_(M,{modelValue:a.pageTitle,"onUpdate:modelValue":e[4]||(e[4]=o=>a.pageTitle=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.PAGE_TITLE.PLACEHOLDER"),"custom-input-class":"!bg-transparent dark:!bg-transparent"},null,8,["modelValue","placeholder"])]),l("div",De,[l("label",xe,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.LABEL")),1),_(M,{modelValue:a.homePageLink,"onUpdate:modelValue":e[5]||(e[5]=o=>a.homePageLink=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.PLACEHOLDER"),"message-type":h.value?"error":"info",message:h.value,"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:e[6]||(e[6]=o=>s(u).homePageLink.$touch()),onBlur:e[7]||(e[7]=o=>s(u).homePageLink.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",Ge,[l("label",Ue,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.SLUG.LABEL")),1),_(M,{modelValue:a.slug,"onUpdate:modelValue":e[8]||(e[8]=o=>a.slug=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.SLUG.PLACEHOLDER"),"message-type":N.value?"error":"info",message:N.value||s(ne)(a.slug),"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:e[9]||(e[9]=o=>s(u).slug.$touch()),onBlur:e[10]||(e[10]=o=>s(u).slug.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",Me,[l("label",be,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.LABEL")),1),_(ie,{modelValue:a.liveChatWidgetInboxId,"onUpdate:modelValue":e[11]||(e[11]=o=>a.liveChatWidgetInboxId=o),options:O.value,placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.PLACEHOLDER"),message:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.HELP_TEXT"),class:"[&>div>button:not(.focused)]:!outline-n-weak"},null,8,["modelValue","options","placeholder","message"])]),l("div",Fe,[l("label",ye,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.BRAND_COLOR.LABEL")),1),l("div",we,[_(re,{modelValue:a.widgetColor,"onUpdate:modelValue":e[12]||(e[12]=o=>a.widgetColor=o)},null,8,["modelValue"])])]),l("div",He,[_(G,{label:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.SAVE_CHANGES"),disabled:!f.value||v.value||s(u).$invalid,"is-loading":v.value,onClick:L},null,8,["label","disabled","is-loading"])])])]))}},ke={__name:"AddCustomDomainDialog",props:{mode:{type:String,default:"add"},customDomain:{type:String,default:""}},emits:["addCustomDomain"],setup(A,{expose:p,emit:r}){const d=A,n=r,{t:i}=y(),c=b(null),a=k({customDomain:d.customDomain}),R={customDomain:{isValidDomain:W.withMessage(()=>i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.FORMAT_ERROR"),Oe)}},O=K(R,a);Z(()=>d.customDomain,u=>{a.customDomain=u});const E=async()=>{await O.value.$validate()&&n("addCustomDomain",a.customDomain)};return p({dialogRef:c}),(u,S)=>(I(),F(z,{ref_key:"dialogRef",ref:c,title:s(i)(`HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.${d.mode.toUpperCase()}_HEADER`),"confirm-button-label":s(i)(`HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.${d.mode.toUpperCase()}_CONFIRM_BUTTON_LABEL`),onConfirm:E},{default:B(()=>[_(M,{modelValue:a.customDomain,"onUpdate:modelValue":S[0]||(S[0]=N=>a.customDomain=N),label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.LABEL"),placeholder:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.PLACEHOLDER"),message:s(O).customDomain.$error?s(O).customDomain.$errors[0].$message:"","message-type":s(O).customDomain.$error?"error":"info",onBlur:S[1]||(S[1]=N=>s(O).customDomain.$touch())},null,8,["modelValue","label","placeholder","message","message-type"])]),_:1},8,["title","confirm-button-label"]))}},Be={class:"flex flex-col gap-6 divide-y divide-n-strong"},Ve={class:"flex flex-col gap-6"},We={class:"flex flex-col gap-2 ltr:pr-10 rtl:pl-10"},qe={class:"text-base font-medium leading-6 text-n-slate-12"},ze={class:"mb-0 text-sm text-n-slate-12"},Ke={class:"flex items-center gap-3 w-full"},Xe={class:"min-h-10 px-3 py-2.5 inline-flex items-center w-full text-sm bg-transparent border rounded-lg text-n-slate-11 border-n-strong"},Je={class:"flex flex-col gap-6 pt-6"},Ze={class:"flex flex-col gap-2 ltr:pr-10 rtl:pl-10"},Ye={class:"text-base font-medium leading-6 text-n-slate-12"},Qe={class:"mb-0 text-sm text-n-slate-12"},je={__name:"DNSConfigurationDialog",props:{customDomain:{type:String,default:""}},emits:["send","close"],setup(A,{expose:p,emit:r}){const d=A,n=r,{t:i}=y(),c=k({email:""}),R=K({email:{email:Re,required:q}},c),O=m(()=>{const{hostURL:f,helpCenterURL:L}=(window==null?void 0:window.chatwootConfig)||{};return X(L)||X(f)||""}),E=m(()=>`${d.customDomain} CNAME ${O.value}`),u=async f=>{f.stopPropagation(),await ue(E.value),C(i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.COPY"))},S=b(null),N=()=>{R.value.$reset(),c.email=""},h=()=>{N(),n("close")},v=async()=>{await R.value.$validate()&&(n("send",c.email),h())};return p({dialogRef:S}),(f,L)=>(I(),F(z,{ref_key:"dialogRef",ref:S,"show-cancel-button":!1,"show-confirm-button":!1,onClose:N},{default:B(()=>[_(G,{icon:"i-lucide-x",sm:"",ghost:"",slate:"",class:"flex-shrink-0 absolute top-2 ltr:right-2 rtl:left-2",onClick:h}),l("div",Be,[l("div",Ve,[l("div",We,[l("h3",qe,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.HEADER")),1),l("p",ze,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.DESCRIPTION")),1)]),l("div",Ke,[l("span",Xe,T(E.value),1),_(G,{faded:"",slate:"",type:"button",icon:"i-lucide-copy",class:"flex-shrink-0",onClick:u})])]),l("div",Je,[l("div",Ze,[l("h3",Ye,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.HEADER")),1),l("p",Qe,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.DESCRIPTION")),1)]),l("form",{class:"flex items-start gap-3 w-full",onSubmit:ee(v,["prevent"])},[_(M,{modelValue:c.email,"onUpdate:modelValue":L[0]||(L[0]=D=>c.email=D),placeholder:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.PLACEHOLDER"),message:s(R).email.$error?s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.ERROR"):"","message-type":s(R).email.$error?"error":"info",class:"w-full",onBlur:L[1]||(L[1]=D=>s(R).email.$touch())},null,8,["modelValue","placeholder","message","message-type"]),_(G,{label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.SEND_BUTTON"),type:"submit",class:"flex-shrink-0"},null,8,["label"])],32)])])]),_:1},512))}},et={class:"flex flex-col w-full gap-6"},tt={class:"flex flex-col gap-2"},st={class:"text-base font-medium text-n-slate-12"},at={class:"text-sm text-n-slate-11"},ot={class:"flex flex-col w-full gap-4"},lt={class:"flex items-center justify-between w-full gap-2"},nt={key:0,class:"flex flex-col gap-1"},it={class:"flex items-center w-full h-8 gap-4"},rt={class:"text-sm font-medium text-n-slate-12"},ut={class:"text-sm text-n-slate-12"},ct={key:0,class:"text-sm text-n-slate-11"},dt={class:"flex items-center"},_t={key:0,class:"flex items-center gap-3"},Et={key:0,class:"flex items-center gap-3 flex-shrink-0"},Tt={key:1,class:"w-px h-3 bg-n-weak"},mt={key:2,class:"w-px h-3 bg-n-weak"},Rt={__name:"PortalConfigurationSettings",props:{activePortal:{type:Object,required:!0},isFetchingStatus:{type:Boolean,required:!0}},emits:["updatePortalConfiguration","refreshStatus","sendCnameInstructions"],setup(A,{emit:p}){const r=A,d=p,n={LIVE:["active","staging_active"],PENDING:["provisioned","pending","initializing","pending_validation","pending_deployment","pending_issuance","holding_deployment","holding_validation","pending_expiration","pending_cleanup","pending_deletion","staging_deployment","backup_issued"],ERROR:["blocked","inactive","moved","expired","deleted","timed_out_initializing","timed_out_validation","timed_out_issuance","timed_out_deployment","timed_out_deletion","deactivating"]},{t:i}=y(),{isOnChatwootCloud:c}=j(),a=b(null),R=b(null),O=b(""),E=m(()=>{var t;return((t=r.activePortal)==null?void 0:t.custom_domain)||""}),u=m(()=>{var t;return((t=r.activePortal)==null?void 0:t.ssl_settings)||{}}),S=m(()=>u.value.verification_errors||""),N=m(()=>n.LIVE.includes(u.value.status)),h=m(()=>n.PENDING.includes(u.value.status)),v=m(()=>n.ERROR.includes(u.value.status)),f=m(()=>N.value?i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.LIVE"):h.value?i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.PENDING"):v.value?i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.ERROR"):""),L=m(()=>N.value?{text:"text-n-teal-11",bubble:"outline-n-teal-6 bg-n-teal-9"}:v.value?{text:"text-n-ruby-11",bubble:"outline-n-ruby-6 bg-n-ruby-9"}:{text:"text-n-amber-11",bubble:"outline-n-amber-6 bg-n-amber-9"}),D=t=>{var o;const e={id:(o=r.activePortal)==null?void 0:o.id,custom_domain:t};d("updatePortalConfiguration",e),a.value.dialogRef.close(),t&&(O.value=t,R.value.dialogRef.open())},g=()=>{O.value="",R.value.dialogRef.close()},P=()=>{d("refreshStatus")},H=t=>{var e;d("sendCnameInstructions",{portalSlug:(e=r.activePortal)==null?void 0:e.slug,email:t})};return(t,e)=>{const o=te("tooltip");return I(),x("div",et,[l("div",tt,[l("h6",st,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.HEADER")),1),l("span",at,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DESCRIPTION")),1)]),l("div",ot,[l("div",lt,[E.value?(I(),x("div",nt,[l("div",it,[l("label",rt,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.LABEL")),1),l("span",ut,T(E.value),1)]),!N.value&&s(c)?(I(),x("span",ct,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS_DESCRIPTION")),1)):U("",!0)])):U("",!0),l("div",dt,[E.value?(I(),x("div",_t,[f.value&&s(c)?se((I(),x("div",Et,[l("span",{class:V(["size-1.5 rounded-full outline outline-2 block flex-shrink-0",L.value.bubble])},null,2),l("span",{class:V([L.value.text,"text-sm leading-[16px] font-medium"])},T(f.value),3)])),[[o,S.value]]):U("",!0),f.value&&s(c)?(I(),x("div",Tt)):U("",!0),_(G,{slate:"",sm:"",link:"",label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.EDIT_BUTTON"),class:"hover:!no-underline flex-shrink-0",onClick:e[0]||(e[0]=w=>a.value.dialogRef.open())},null,8,["label"]),s(c)?(I(),x("div",mt)):U("",!0),s(c)?(I(),F(G,{key:3,slate:"",sm:"",link:"",icon:"i-lucide-refresh-ccw",class:V(A.isFetchingStatus&&"animate-spin"),onClick:P},null,8,["class"])):U("",!0)])):(I(),F(G,{key:1,label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.ADD_BUTTON"),color:"slate",onClick:e[1]||(e[1]=w=>a.value.dialogRef.open())},null,8,["label"]))])])]),_(ke,{ref_key:"addCustomDomainDialogRef",ref:a,mode:E.value?"edit":"add","custom-domain":E.value,onAddCustomDomain:D},null,8,["mode","custom-domain"]),_(je,{ref_key:"dnsConfigurationDialogRef",ref:R,"custom-domain":O.value||E.value,onClose:g,onSend:H},null,8,["custom-domain"])])}}},pt={__name:"ConfirmDeletePortalDialog",props:{activePortalName:{type:String,required:!0}},emits:["deletePortal"],setup(A,{expose:p,emit:r}){const d=r,{t:n}=y(),i=b(null),c=()=>{d("deletePortal")};return p({dialogRef:i}),(a,R)=>(I(),F(z,{ref_key:"dialogRef",ref:i,type:"alert",title:s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.HEADER",{portalName:A.activePortalName}),description:s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.DESCRIPTION"),"confirm-button-label":s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.CONFIRM_BUTTON_LABEL"),onConfirm:c},null,8,["title","description","confirm-button-label"]))}},gt={key:0,class:"flex items-center justify-center py-10 pt-2 pb-8 text-n-slate-11"},Ot={key:1,class:"flex flex-col w-full gap-4 max-w-[40rem] pb-8"},St={class:"flex items-end justify-between w-full gap-4"},Nt={class:"flex flex-col gap-2"},It={class:"text-base font-medium text-n-slate-12"},ft={class:"text-sm text-n-slate-11"},At={__name:"PortalSettings",props:{portals:{type:Array,required:!0},isFetching:{type:Boolean,required:!0}},emits:["updatePortal","updatePortalConfiguration","deletePortal","refreshStatus","sendCnameInstructions"],setup(A,{emit:p}){const r=A,d=p,{t:n}=y(),i=Q(),c=b(null),a=m(()=>i.params.portalSlug),R=$("portals/isSwitchingPortal"),O=$("portals/isFetchingSSLStatus"),E=m(()=>{var g;return(g=r.portals)==null?void 0:g.find(P=>P.slug===a.value)}),u=m(()=>{var g;return((g=E.value)==null?void 0:g.name)||""}),S=m(()=>r.isFetching||R.value),N=g=>{d("updatePortal",g)},h=g=>{d("updatePortalConfiguration",g)},v=()=>{d("refreshStatus")},f=g=>{d("sendCnameInstructions",g)},L=()=>{c.value.dialogRef.open()},D=()=>{d("deletePortal",E.value),c.value.dialogRef.close()};return(g,P)=>(I(),F(de,{"show-pagination-footer":!1},{content:B(()=>[S.value?(I(),x("div",gt,[_(pe)])):E.value?(I(),x("div",Ot,[_($e,{"active-portal":E.value,"is-fetching":A.isFetching,onUpdatePortal:N},null,8,["active-portal","is-fetching"]),P[0]||(P[0]=l("div",{class:"w-full h-px bg-n-weak"},null,-1)),_(Rt,{"active-portal":E.value,"is-fetching":A.isFetching,"is-fetching-status":s(O),onUpdatePortalConfiguration:h,onRefreshStatus:v,onSendCnameInstructions:f},null,8,["active-portal","is-fetching","is-fetching-status"]),P[1]||(P[1]=l("div",{class:"w-full h-px bg-n-weak"},null,-1)),l("div",St,[l("div",Nt,[l("h6",It,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.HEADER")),1),l("span",ft,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DESCRIPTION")),1)]),_(G,{label:s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.BUTTON",{portalName:u.value}),color:"ruby",class:"max-w-56 !w-fit",onClick:L},null,8,["label"])])])):U("",!0)]),default:B(()=>[_(pt,{ref_key:"confirmDeletePortalDialogRef",ref:c,"active-portal-name":u.value,onDeletePortal:D},null,8,["active-portal-name"])]),_:1}))}},Lt=5e3,Yt={__name:"PortalsSettingsIndexPage",setup(A){const{t:p}=y(),r=Y(),d=Q(),n=le(),{isOnChatwootCloud:i}=j(),{updateUISettings:c}=ce(),a=$("portals/allPortals"),R=$("portals/isFetchingPortals"),O=$("portals/portalBySlug"),E=t=>{var e;return((e=a.value)==null?void 0:e.find(o=>o.slug!==t))??null},u=t=>{var e,o;return(o=(e=O.value(t))==null?void 0:e.meta)==null?void 0:o.default_locale},S=()=>{if(!i.value)return;const{portalSlug:t}=d.params;r.dispatch("portals/sslStatus",{portalSlug:t})},N=async(t,e)=>{const o={portalSlug:t,locale:e};await Promise.all([r.dispatch("portals/index"),r.dispatch("portals/show",o),r.dispatch("categories/index",o),r.dispatch("agents/get"),r.dispatch("inboxes/get")])},h=async t=>{const e=E(t);if(e){const{slug:o,meta:{default_locale:w}}=e;await N(o,w),n.push({name:"portals_articles_index",params:{portalSlug:o,locale:w}})}else n.push({name:"portals_new"})},v=async(t,e)=>{await N(t,e),c({last_active_portal_slug:t,last_active_locale_code:e}),await n.replace({name:"portals_settings_index",params:{portalSlug:t}})},f=async t=>{const{portalSlug:e}=d.params;try{const o=u(e);await r.dispatch("portals/update",{...t,portalSlug:e||(t==null?void 0:t.slug)}),t!=null&&t.slug&&e!==t.slug&&await v(t.slug,o),C(p("HELP_CENTER.PORTAL_SETTINGS.API.UPDATE_PORTAL.SUCCESS_MESSAGE"))}catch(o){C((o==null?void 0:o.message)||p("HELP_CENTER.PORTAL_SETTINGS.API.UPDATE_PORTAL.ERROR_MESSAGE"))}},L=async t=>{const{slug:e}=t;try{await r.dispatch("portals/delete",{portalSlug:e}),await h(e),C(p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_SUCCESS"))}catch(o){C((o==null?void 0:o.message)||p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_ERROR"))}},D=async t=>{try{await r.dispatch("portals/sendCnameInstructions",t),C(p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.SEND_CNAME_INSTRUCTIONS.API.SUCCESS_MESSAGE"))}catch(e){C((e==null?void 0:e.message)||p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.SEND_CNAME_INSTRUCTIONS.API.ERROR_MESSAGE"))}},g=f,P=t=>{f(t),t!=null&&t.custom_domain&&i.value&&setTimeout(()=>{S()},Lt)},H=L;return(t,e)=>(I(),F(At,{portals:s(a),"is-fetching":s(R),onUpdatePortal:s(g),onUpdatePortalConfiguration:P,onDeletePortal:s(H),onRefreshStatus:S,onSendCnameInstructions:D},null,8,["portals","is-fetching","onUpdatePortal","onDeletePortal"]))}};export{Yt as default};
//# sourceMappingURL=PortalsSettingsIndexPage-D8527UoR.js.map
