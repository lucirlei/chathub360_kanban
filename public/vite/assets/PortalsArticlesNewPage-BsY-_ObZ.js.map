{"version":3,"file":"PortalsArticlesNewPage-BsY-_ObZ.js","sources":["../../../app/javascript/dashboard/routes/dashboard/helpcenter/pages/PortalsArticlesNewPage.vue"],"sourcesContent":["<script setup>\nimport { ref, computed } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useI18n } from 'vue-i18n';\nimport { useAlert, useTrack } from 'dashboard/composables';\nimport { useStore, useMapGetter } from 'dashboard/composables/store';\nimport { PORTALS_EVENTS } from 'dashboard/helper/AnalyticsHelper/events';\n\nimport ArticleEditor from 'dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditor.vue';\n\nconst route = useRoute();\nconst router = useRouter();\nconst store = useStore();\nconst { t } = useI18n();\n\nconst { portalSlug } = route.params;\n\nconst selectedAuthorId = ref(null);\nconst selectedCategoryId = ref(null);\n\nconst currentUserId = useMapGetter('getCurrentUserID');\nconst categories = useMapGetter('categories/allCategories');\n\nconst categoryId = computed(() => categories.value[0]?.id || null);\n\nconst article = ref({});\nconst isUpdating = ref(false);\nconst isSaved = ref(false);\n\nconst setAuthorId = authorId => {\n  selectedAuthorId.value = authorId;\n};\n\nconst setCategoryId = newCategoryId => {\n  selectedCategoryId.value = newCategoryId;\n};\n\nconst createNewArticle = async ({ title, content }) => {\n  if (title) article.value.title = title;\n  if (content) article.value.content = content;\n\n  if (!article.value.title || !article.value.content) return;\n\n  isUpdating.value = true;\n  try {\n    const { locale } = route.params;\n    const articleId = await store.dispatch('articles/create', {\n      portalSlug,\n      content: article.value.content,\n      title: article.value.title,\n      locale: locale,\n      authorId: selectedAuthorId.value || currentUserId.value,\n      categoryId: selectedCategoryId.value || categoryId.value,\n    });\n\n    useTrack(PORTALS_EVENTS.CREATE_ARTICLE, { locale });\n\n    router.replace({\n      name: 'portals_articles_edit',\n      params: {\n        articleSlug: articleId,\n        portalSlug,\n        locale,\n      },\n    });\n  } catch (error) {\n    const errorMessage =\n      error?.message || t('HELP_CENTER.EDIT_ARTICLE_PAGE.API.ERROR');\n    useAlert(errorMessage);\n  } finally {\n    isUpdating.value = false;\n  }\n};\n\nconst goBackToArticles = () => {\n  const { tab, categorySlug, locale } = route.params;\n  router.push({\n    name: 'portals_articles_index',\n    params: { tab, categorySlug, locale },\n  });\n};\n</script>\n\n<template>\n  <ArticleEditor\n    :article=\"article\"\n    :is-updating=\"isUpdating\"\n    :is-saved=\"isSaved\"\n    @save-article=\"createNewArticle\"\n    @go-back=\"goBackToArticles\"\n    @set-author=\"setAuthorId\"\n    @set-category=\"setCategoryId\"\n  />\n</template>\n"],"names":["route","useRoute","router","useRouter","store","useStore","t","useI18n","portalSlug","selectedAuthorId","ref","selectedCategoryId","currentUserId","useMapGetter","categories","categoryId","computed","_a","article","isUpdating","isSaved","setAuthorId","authorId","setCategoryId","newCategoryId","createNewArticle","title","content","locale","articleId","useTrack","PORTALS_EVENTS","error","errorMessage","useAlert","goBackToArticles","tab","categorySlug"],"mappings":"2gCAUA,MAAMA,EAAQC,EAAU,EAClBC,EAASC,EAAW,EACpBC,EAAQC,EAAU,EAClB,CAAE,EAAAC,CAAG,EAAGC,EAAS,EAEjB,CAAE,WAAAC,CAAU,EAAKR,EAAM,OAEvBS,EAAmBC,EAAI,IAAI,EAC3BC,EAAqBD,EAAI,IAAI,EAE7BE,EAAgBC,EAAa,kBAAkB,EAC/CC,EAAaD,EAAa,0BAA0B,EAEpDE,EAAaC,EAAS,WAAM,QAAAC,EAAAH,EAAW,MAAM,CAAC,IAAlB,YAAAG,EAAqB,KAAM,KAAI,EAE3DC,EAAUR,EAAI,EAAE,EAChBS,EAAaT,EAAI,EAAK,EACtBU,EAAUV,EAAI,EAAK,EAEnBW,EAAcC,GAAY,CAC9Bb,EAAiB,MAAQa,CAC3B,EAEMC,EAAgBC,GAAiB,CACrCb,EAAmB,MAAQa,CAC7B,EAEMC,EAAmB,MAAO,CAAE,MAAAC,EAAO,QAAAC,KAAc,CAIrD,GAHID,IAAOR,EAAQ,MAAM,MAAQQ,GAC7BC,IAAST,EAAQ,MAAM,QAAUS,GAEjC,GAACT,EAAQ,MAAM,OAAS,CAACA,EAAQ,MAAM,SAE3C,CAAAC,EAAW,MAAQ,GACnB,GAAI,CACF,KAAM,CAAE,OAAAS,GAAW5B,EAAM,OACnB6B,EAAY,MAAMzB,EAAM,SAAS,kBAAmB,CACxD,WAAAI,EACA,QAASU,EAAQ,MAAM,QACvB,MAAOA,EAAQ,MAAM,MACrB,OAAQU,EACR,SAAUnB,EAAiB,OAASG,EAAc,MAClD,WAAYD,EAAmB,OAASI,EAAW,KACzD,CAAK,EAEDe,EAASC,EAAe,eAAgB,CAAE,OAAAH,CAAM,CAAE,EAElD1B,EAAO,QAAQ,CACb,KAAM,wBACN,OAAQ,CACN,YAAa2B,EACb,WAAArB,EACA,OAAAoB,CACD,CACP,CAAK,CACF,OAAQI,EAAO,CACd,MAAMC,GACJD,GAAA,YAAAA,EAAO,UAAW1B,EAAE,yCAAyC,EAC/D4B,EAASD,CAAY,CACzB,QAAY,CACRd,EAAW,MAAQ,EACvB,EACA,EAEMgB,EAAmB,IAAM,CAC7B,KAAM,CAAE,IAAAC,EAAK,aAAAC,EAAc,OAAAT,CAAQ,EAAG5B,EAAM,OAC5CE,EAAO,KAAK,CACV,KAAM,yBACN,OAAQ,CAAE,IAAAkC,EAAK,aAAAC,EAAc,OAAAT,CAAQ,CACzC,CAAG,CACH"}